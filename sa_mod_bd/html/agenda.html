<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Conserta Tech - Agenda</title>
    <link rel="stylesheet" href="css/css_agenda.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/css-home-bar.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
</head>
<body>
  <div class="container-geral">
    <nav class="menu-lateral">
        <div class="btn-expandir"></div>

        <div class="top-menu">
            <ul>
                <li class="item-menu">
                    <a href="main.html" class="menu-link">
                        <span class="icon"><i class="bi bi-house-door"></i></span>
                        <span class="txt-link">Menu</span>
                    </a>
                </li>
                <li class="item-menu">
                    <a href="agenda.html" class="menu-link">
                        <span class="icon"><i class="bi bi-calendar"></i></span>
                        <span class="txt-link">Agenda</span>
                    </a>
                </li>
                <li class="item-menu">
                    <a href="cliente.html" class="menu-link">
                        <span class="icon"><i class="bi bi-person-fill"></i></span>
                        <span class="txt-link">Cadastrar Cliente</span>
                    </a>
                </li>
                <li class="item-menu">
                    <a href="usuario.html" class="menu-link">
                        <span class="icon"><i class="bi bi-person-circle"></i></span>
                        <span class="txt-link">Cadastro Usuário</span>
                    </a>
                </li>
                <li class="item-menu">
                    <a href="fornecedor.html" class="menu-link">
                        <span class="icon"><i class="bi bi-truck"></i></span>
                        <span class="txt-link">Cadastro Fornecedor</span>
                    </a>
                </li>
                <li class="item-menu">
                    <a href="#" id="estoque" class="menu-link">
                        <span class="icon"><i class="bi bi-box-seam"></i></span>
                        <span class="txt-link">Estoque <i class="bi bi-chevron-down"></i></span>
                    </a>
                    <div id="sub-estoque" class="sub-menu">
                        <a href="estoque_cad.html"><i class="bi bi-circle-fill"></i> Adicionar Estoque</a>
                    </div>
                </li>
                <li class="item-menu">
                    <a href="orcamento.html" id="orcamento" class="menu-link">
                        <span class="icon"><i class="bi bi-receipt-cutoff"></i></span>
                        <span class="txt-link">Orçamento <i class="bi bi-chevron-down"></i></span>
                    </a>
                    <div id="sub-orcamento" class="sub-menu">
                        <a href="financas.html"><i class="bi bi-circle-fill"></i> Finanças</a>
                        <a href="emitir_nf.html"><i class="bi bi-circle-fill"></i> Emitir NF</a>
                    </div>
                </li>
                <li class="item-menu">
                    <a href="os.html" class="menu-link">
                        <span class="icon"><i class="bi bi-tools"></i></span>
                        <span class="txt-link">O.S</span>
                    </a>
                </li>
            </ul>
        </div>

        <!-- Rodapé -->
        <div class="footer-contato">
            <div class="linha-info">
                <p class="duvidas">Dúvidas?<br><span>Consulte-nos</span></p>
                <p class="telefone">3025-5458</p>
            </div>
            <p class="empresa">Conserta tech</p>
        </div>
    </nav>
  </div>

  <script src="js/barra_lateral.js"></script>
</body>



    <div class="conteudo">
        <h1>AGENDA</h1>

        <div class="calendario">
            <div class="cabecalho">
                <button id="mesAnterior">&lt;</button>
                <span id="mesAno">Maio 2025</span>
                <button id="mesProximo">&gt;</button>
              </div>
              <div class="dias-semana">
                <div>Dom</div><div>Seg</div><div>Ter</div><div>Qua</div><div>Qui</div><div>Sex</div><div>Sáb</div>
              </div>
              <div class="dias" id="diasCalendario">
                <!-- Os dias serão preenchidos via JavaScript -->
              </div>
        </div>

        <div class="botoes">
            <button class="pesquisar">Pesquisar</button>
            <button class="novo">Novo</button>
        </div>

        <form class="formulario">
            <div class="linha">
                <label>Data:</label>
                <input class="input-longo" type="text" id="campoData" placeholder="DD/MM/AAAA">
                <label>Código OS:</label>
                <input type="text">
            </div>
        </form>

        <h1 class = "pesquisa">PESQUISA</h1>
    </div>

    <div id="modal">
      <div class="modal-conteudo">
        <h2 class="modal-titulo">Adicionar Evento</h2>
    
        <label for="inputTitulo">Título:</label>
        <input type="text" id="inputTitulo" />
    
        <label for="inputDescricao">Descrição:</label>
        <textarea id="inputDescricao" rows="4"></textarea>
    
        <p id="dataSelecionada"></p>
    
        <div class="botoes-modal">
          <button class="salvar">Salvar</button>
          <button class="fechar">Fechar</button>
        </div>
      </div>
    </div>

    <script>
        // Pega todos os dias do calendário
        const dias = document.querySelectorAll('.dias div:not(.vazio)');
        const modal = document.getElementById('modal');
        const dataSpan = document.getElementById('dataSelecionada');
        const fecharBtn = document.querySelector('.fechar');
        const eventosPorData = {};
      
        dias.forEach(dia => {
          dia.addEventListener('click', () => {
            const numero = dia.textContent;
            dataSpan.textContent = numero + " de Maio de 2025"; // Pode atualizar dinamicamente depois
            modal.style.display = 'block';
          });
        });
      
        fecharBtn.addEventListener('click', () => {
          modal.style.display = 'none';
        });
      
        // Fecha se clicar fora do conteúdo do modal
        window.addEventListener('click', (e) => {
          if (e.target === modal) {
            modal.style.display = 'none';
          }
        });

        const meses = [
    "Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho",
    "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"
  ];

  const diasSemana = ["Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sáb"];
  let dataAtual = new Date(2025, 4); // Maio 2025 (mês começa do 0)

  const mesAno = document.getElementById("mesAno");
  const diasCalendario = document.getElementById("diasCalendario");

  function renderizarCalendario() {
    const ano = dataAtual.getFullYear();
    const mes = dataAtual.getMonth();
    const primeiroDia = new Date(ano, mes, 1);
    const ultimoDia = new Date(ano, mes + 1, 0);
    const diaSemanaInicio = primeiroDia.getDay();
    const totalDias = ultimoDia.getDate();

    mesAno.textContent = `${meses[mes]} ${ano}`;
    diasCalendario.innerHTML = "";

    // Espaços vazios até o primeiro dia
    for (let i = 0; i < diaSemanaInicio; i++) {
      const vazio = document.createElement("div");
      vazio.classList.add("vazio");
      diasCalendario.appendChild(vazio);
    }

    // Dias do mês
    for (let dia = 1; dia <= totalDias; dia++) {
      const divDia = document.createElement("div");
      divDia.textContent = dia;
      divDia.classList.add("dia");

      const dataChave = `${ano}-${mes + 1}-${dia}`;
      if (eventosPorData[dataChave]) {
        const barraEvento = document.createElement("div");
        barraEvento.classList.add("evento-barra");

        barraEvento.addEventListener("click", (e) => {
        e.stopPropagation(); // evita disparar o evento do dia
        abrirModal(dia, mes, ano);
      });

  divDia.appendChild(barraEvento);
}


      divDia.addEventListener("click", () => abrirModal(dia, mes, ano));
      diasCalendario.appendChild(divDia);
    }
  }

  function abrirModal(dia, mes, ano) {
  const modal = document.getElementById('modal');
  const dataSpan = document.getElementById('dataSelecionada');
  const inputTitulo = document.getElementById('inputTitulo');
  const inputDescricao = document.getElementById('inputDescricao');
  const dataChave = `${ano}-${mes + 1}-${dia}`;

  dataSpan.textContent = `${dia} de ${meses[mes]} de ${ano}`;

  const evento = eventosPorData[dataChave] || { titulo: '', descricao: '' };

  inputTitulo.value = evento.titulo;
  inputDescricao.value = evento.descricao;
  inputTitulo.setAttribute('data-chave', dataChave);

  modal.style.display = 'block';
  };

  document.querySelector('.salvar').addEventListener('click', () => {
  const modal = document.getElementById('modal');
  const inputTitulo = document.getElementById('inputTitulo');
  const inputDescricao = document.getElementById('inputDescricao');
  const dataChave = inputTitulo.getAttribute('data-chave');
  const titulo = inputTitulo.value.trim();
  const descricao = inputDescricao.value.trim();

  if (titulo !== '' || descricao !== '') {
    eventosPorData[dataChave] = { titulo, descricao };
  } else {
    delete eventosPorData[dataChave]; // Remove evento vazio
  }

  modal.style.display = 'none';
  renderizarCalendario(); // Atualiza visualmente
  });

  document.getElementById("mesAnterior").addEventListener("click", () => {
    dataAtual.setMonth(dataAtual.getMonth() - 1);
    renderizarCalendario();
  });

  document.getElementById("mesProximo").addEventListener("click", () => {
    dataAtual.setMonth(dataAtual.getMonth() + 1);
    renderizarCalendario();
  });

  // Fecha o modal
  document.querySelector('.fechar').addEventListener('click', () => {
    document.getElementById('modal').style.display = 'none';
  });

  window.addEventListener('click', (e) => {
    if (e.target === document.getElementById('modal')) {
      document.getElementById('modal').style.display = 'none';
    }
  });

  diasCalendario.classList.remove("fade");
    void diasCalendario.offsetWidth; // força reflow
    diasCalendario.classList.add("fade");

    document.querySelector('.novo').addEventListener('click', () => {
  document.querySelector('.formulario').reset();

  // Limpa também o campo de data "manualmente", para restaurar o placeholder
  campoData.value = '';
  });

  renderizarCalendario(); // Inicializa ao carregar a página
</script>

<script>
  const campoData = document.getElementById('campoData');

  campoData.addEventListener('input', (e) => {
    let valor = e.target.value.replace(/\D/g, ''); // Remove não dígitos
    if (valor.length > 8) valor = valor.slice(0, 8);

    let formatado = '';
    if (valor.length > 4) {
      formatado = valor.slice(0, 2) + '/' + valor.slice(2, 4) + '/' + valor.slice(4);
    } else if (valor.length > 2) {
      formatado = valor.slice(0, 2) + '/' + valor.slice(2);
    } else {
      formatado = valor;
    }

    e.target.value = formatado;
  });
</script>

<script>
  campoData.addEventListener('blur', () => {
    const valor = campoData.value;
    const partes = valor.split('/');

    if (partes.length === 3) {
      const dia = parseInt(partes[0], 10);
      const mes = parseInt(partes[1], 10) - 1; // meses começam do zero
      const ano = parseInt(partes[2], 10);

      const novaData = new Date(ano, mes, dia);

      if (
        novaData &&
        novaData.getFullYear() === ano &&
        novaData.getMonth() === mes &&
        novaData.getDate() === dia
      ) {
        dataAtual = new Date(ano, mes);
        renderizarCalendario();

        // Destaca o dia no calendário (opcional)
        setTimeout(() => {
          const dias = document.querySelectorAll('#diasCalendario .dia');
          dias.forEach(d => {
            if (parseInt(d.textContent, 10) === dia) {
              d.classList.add('selecionado');
              d.scrollIntoView({ behavior: 'smooth', block: 'center' });
            } else {
              d.classList.remove('selecionado');
            }
          });
        }, 0);
      }
    }
  });
  
</script>
</body>
</html>